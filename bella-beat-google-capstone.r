{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8c5f44a3",
   "metadata": {
    "_cell_guid": "b16e0c18-8c3f-4bc5-9ff5-c6cd411cd60c",
    "_uuid": "3a307216-8c02-46a2-b1ba-93b9db472f9a",
    "execution": {
     "iopub.execute_input": "2024-09-24T21:22:01.007804Z",
     "iopub.status.busy": "2024-09-24T21:22:01.005282Z",
     "iopub.status.idle": "2024-09-24T21:22:01.027271Z"
    },
    "jupyter": {
     "outputs_hidden": false
    },
    "papermill": {
     "duration": 0.00308,
     "end_time": "2024-09-24T21:27:00.987328",
     "exception": false,
     "start_time": "2024-09-24T21:27:00.984248",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "---\n",
    "title: \"BellaBeat Case Study:Marketing Analytics\"\n",
    "author: \"Ropafadzo Muridzi\"\n",
    "date: \"`r Sys.Date()`\"\n",
    "output:\n",
    "  html_document: default\n",
    "  pdf_document: default\n",
    "---\n",
    "\n",
    "```{r setup, include=FALSE}\n",
    "knitr::opts_chunk$set(echo = TRUE)\n",
    "```\n",
    "\n",
    "## Goal\n",
    "\n",
    "The goal of this project is to analyse smart device fitness data and gain insight on how consumers are using their smart device and develop an improved marketing strategy for Bellabeat Time product.\n",
    "\n",
    "### Objectives\n",
    "1.\tUnderstand consumer behaviour and usage patterns.\n",
    "2.\tIdentify trends and preferences in smart fitness device usage\n",
    "3.\tDevelop an improved marketing strategy for BellaBeat Time.\n",
    "\n",
    "### Key Performance Indicators\n",
    "1.\tUser engagement (daily active users, session length)\n",
    "2.\tActivity tracking (steps, distance, calories burned)\n",
    "3.\tSleep patterns and quality\n",
    "4.\tDemographic analysis (age, gender, location)\n",
    "5.\tCustomer retention and satisfaction\n",
    "\n",
    "## Data Preparation\n",
    "\n",
    "### Data Collection\n",
    "This project will relies on the FitBit Fitness Tracker data from on Kaggle which contains personal fitness tracker. The dataset was generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016.\n",
    "\n",
    "\n",
    "\n",
    "## Data Inspection\n",
    "### Check data types\n",
    "\n",
    "In this section I shall be examined data for errors,inconsistencices and missing  values\n",
    "\n",
    "\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    " \n",
    "skim_without_charts(dailyActivity)\n",
    "skim_without_charts(dailyCalories)\n",
    "skim_without_charts(dailyIntensities)\n",
    "skim_without_charts(dailySteps)\n",
    "skim_without_charts(heatrateSeconds)\n",
    "skim_without_charts(hourlyCalories)\n",
    "skim_without_charts(hourlyIntensities)\n",
    "skim_without_charts(hourlySteps)\n",
    "skim_without_charts(minuteCaloriesNarrow)\n",
    "skim_without_charts(minuteCaloriesWide)\n",
    "skim_without_charts(minuteIntensitiesWide)\n",
    "skim_without_charts(minuteIntensitiesNarrow)\n",
    "skim_without_charts(minuteMETsNarrow)\n",
    "skim_without_charts(minuteStepsWide)\n",
    "skim_without_charts(minuteStepsNarrow)\n",
    "skim_without_charts(minuteSleepWide)\n",
    "skim_without_charts(sleepDay)\n",
    "skim_without_charts(weightLogInfo)\n",
    "\n",
    "\n",
    "###Dataframe viewing\n",
    "\n",
    "head(dailyActivity)\n",
    "head(dailyCalories)\n",
    "head(dailyIntensities)\n",
    "head(dailySteps)\n",
    "head(heatrateSeconds)\n",
    "head(hourlyCalories)\n",
    "head(hourlyIntensities)\n",
    "head(hourlySteps)\n",
    "head(minuteCaloriesNarrow)\n",
    "head(minuteCaloriesWide)\n",
    "head(minuteIntensitiesWide)\n",
    "head(minuteIntensitiesNarrow)\n",
    "head(minuteMETsNarrow)\n",
    "head(minuteStepsWide)\n",
    "head(minuteStepsNarrow)\n",
    "head(minuteSleepWide)\n",
    "head(sleepDay)\n",
    "head(weightLogInfo)\n",
    "\n",
    "###Check for duplicates and na values\n",
    "\n",
    "\n",
    "dailyActivity   %>%duplicated()%>%sum()\n",
    "which(is.na(dailyActivity)) \n",
    "\n",
    "dailyCalories    %>%duplicated()%>%sum()\n",
    "which(is.na(dailyCalories)) \n",
    "\n",
    "dailyIntensities  %>%duplicated()%>%sum()\n",
    "which(is.na(dailyIntensities)) \n",
    "\n",
    "dailySteps  %>% duplicated()%>%sum()\n",
    "which(is.na(dailySteps)) %>% sum(is.na(dailySteps))\n",
    "\n",
    "heatrateSeconds %>% duplicated()%>%sum()\n",
    "which(is.na(heatrateSeconds)) \n",
    "\n",
    "hourlyCalories %>%duplicated()%>%sum()\n",
    "which(is.na(hourlyCalories)) \n",
    "\n",
    "hourlyIntensities %>%duplicated()%>%sum()\n",
    "which(is.na(hourlyIntensities))\n",
    "\n",
    "hourlySteps %>%duplicated()%>%sum()\n",
    "which(is.na(hourlySteps)) \n",
    "\n",
    "minuteCaloriesNarrow  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteCaloriesNarrow)) \n",
    "\n",
    "minuteCaloriesWide  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteCaloriesWide)) \n",
    "\n",
    "minuteIntensitiesWide  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteIntensitiesWide)) \n",
    "\n",
    "minuteIntensitiesNarrow  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteIntensitiesNarrow)) \n",
    "\n",
    "minuteMETsNarrow  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteMETsNarrow))\n",
    "\n",
    "minuteStepsWide  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteStepsWide))\n",
    "\n",
    "minuteStepsNarrow  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteStepsNarrow))\n",
    "\n",
    "minuteSleepWide  %>%duplicated()%>%sum()\n",
    "which(is.na(minuteSleepWide)) \n",
    "\n",
    "sleepDay  %>%duplicated()%>%sum()\n",
    "which(is.na(sleepDay)) \n",
    "\n",
    "weightLogInfo %>%duplicated()%>%sum()\n",
    "which(is.na(weightLogInfo))\n",
    "```\n",
    " \n",
    "\n",
    "After running the above queries,The following issues were found.\n",
    "1.The date columns for all tables needed to be formatted in to date.\n",
    "2.The weight table had some NA values that need to be removed.\n",
    "3.Time in some tables was put as date and time and needs to be split into two columns.\n",
    "4.All the column names need to formatted into snake_cased and some need to be renamed\n",
    "5.sleepday had duplicates\n",
    "\n",
    "### Data Limitations\n",
    "\n",
    "The datasets do not contain user demographics like age and location which could be useful to draw some useful insights.\n",
    "\n",
    "### Data Cleaning\n",
    "The following activities were done in this phase to handle missing values,remove duplicates and correct errors.\n",
    "1.clean column names\n",
    "2.format date\n",
    "3.sort data by date\n",
    "4.split data and create new dcolumns\n",
    "\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "\n",
    "######Daily Activity Data.\n",
    "\n",
    "\n",
    "dailyActivity <- dailyActivity   %>%\n",
    "  clean_names() \n",
    "colnames(dailyActivity)[2] <- \"date\" \n",
    "dailyActivity <- dailyActivity %>%\n",
    "  mutate(date = as.Date(date,\"%m/%d/%Y\")) %>%\n",
    "  group_by(id,date)\n",
    "print(dailyActivity)\n",
    "  \n",
    "  \n",
    "######Daily Calories Data.\n",
    "dailyCalories <- dailyCalories   %>%\n",
    "  clean_names() \n",
    "colnames(dailyCalories)[2] <- \"date\" \n",
    "dailyCalories <- dailyCalories %>%\n",
    "  mutate(date = as.Date(date,\"%m/%d/%Y\")) %>%\n",
    "  group_by(id,date)\n",
    "print(dailyCalories)\n",
    "\n",
    "######Daily Intensities Data.\n",
    "dailyIntensities <- dailyIntensities   %>%\n",
    "  clean_names() \n",
    "colnames(dailyIntensities)[2] <- \"date\" \n",
    "dailyIntensities <- dailyIntensities %>%\n",
    "  mutate(date = as.Date(date,\"%m/%d/%Y\")) %>%\n",
    "  group_by(id,date)\n",
    "print(dailyCalories)\n",
    "\n",
    "\n",
    "\n",
    "######Daily Steps Data.\n",
    "dailySteps <- dailySteps   %>%\n",
    "  clean_names() \n",
    "colnames(dailySteps)[2] <- \"date\" \n",
    "dailySteps <- dailySteps %>%\n",
    "  mutate(date = as.Date(date,\"%m/%d/%Y\")) %>%\n",
    "  group_by(id,date)\n",
    "print(dailyCalories)\n",
    "\n",
    "###### HeartRate Data.\n",
    "heatrateSeconds <- heatrateSeconds   %>%\n",
    "  clean_names() \n",
    "heatrateSeconds <- heatrateSeconds %>%\n",
    "  mutate(time = parse_date_time(time, \"%m/%d/%Y %I:%M:%S\"))\n",
    "heatrateSeconds <- heatrateSeconds %>%\n",
    "separate(col = time, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    " \n",
    "  mutate(date = as.Date(date),\n",
    "         time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "colnames(heatrateSeconds)[4] <- \"heart_rate\"\n",
    "print(heatrateSeconds)\n",
    "\n",
    "\n",
    "\n",
    "###### hourly Calories Data.\n",
    "hourlyCalories <- hourlyCalories   %>%\n",
    "  clean_names() \n",
    "colnames(hourlyCalories)[2] <- \"hour\"\n",
    "hourlyCalories <- hourlyCalories %>%\n",
    "  mutate(hour = parse_date_time(hour, \"%m/%d/%Y %I:%M:%S\"))\n",
    "hourlyCalories <- hourlyCalories %>%\n",
    "  separate(col = hour, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(hourlyCalories)\n",
    "\n",
    "\n",
    "###### hourly Intensities Data.\n",
    "hourlyIntensities <- hourlyIntensities   %>%\n",
    "  clean_names() \n",
    "colnames(hourlyIntensities)[2] <- \"hour\"\n",
    "hourlyIntensities <- hourlyIntensities %>%\n",
    "  mutate(hour = parse_date_time(hour, \"%m/%d/%Y %I:%M:%S\"))\n",
    "hourlyIntensities <- hourlyIntensities %>%\n",
    "  separate(col = hour, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(hourlyCalories)\n",
    "\n",
    "###### hourly Steps Data.\n",
    "\n",
    "hourlySteps <- hourlySteps   %>%\n",
    "  clean_names() \n",
    "colnames(hourlySteps)[2] <- \"hour\"\n",
    "colnames(hourlySteps)[3] <- \"total_steps\"\n",
    "hourlySteps <- hourlySteps %>%\n",
    "  mutate(hour = parse_date_time(hour, \"%m/%d/%Y %I:%M:%S\"))\n",
    "hourlySteps <- hourlySteps %>%\n",
    "  separate(col = hour, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(hourlySteps)\n",
    "\n",
    "\n",
    "###### minute Calories Data.\n",
    "\n",
    "minuteCaloriesNarrow <- minuteCaloriesNarrow   %>%\n",
    "  clean_names() \n",
    "colnames(minuteCaloriesNarrow)[2] <- \"minutes\"\n",
    "minuteCaloriesNarrow <- minuteCaloriesNarrow %>%\n",
    "  mutate(minutes = parse_date_time(minutes, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteCaloriesNarrow <- minuteCaloriesNarrow %>%\n",
    "  separate(col = minutes, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteCaloriesNarrow)\n",
    "\n",
    "\n",
    "###### Minute Calories Data.\n",
    "minuteCaloriesWide <- minuteCaloriesWide   %>%\n",
    "  clean_names() \n",
    "colnames(minuteCaloriesWide)[2] <- \"hour\"\n",
    "minuteCaloriesWide <- minuteCaloriesWide %>%\n",
    "  mutate(hour = parse_date_time(hour, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteCaloriesWide <- minuteCaloriesWide %>%\n",
    "  separate(col = hour, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteCaloriesWide)\n",
    "\n",
    "\n",
    "###### minute Intensities Data Wide.\n",
    "\n",
    "minuteIntensitiesWide <- minuteIntensitiesWide   %>%\n",
    "  clean_names() \n",
    "colnames(minuteIntensitiesWide)[2] <- \"minutes\"\n",
    "minuteIntensitiesWide <- minuteIntensitiesWide %>%\n",
    "  mutate(minutes = parse_date_time(minutes, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteIntensitiesWide <- minuteIntensitiesWide %>%\n",
    "  separate(col = minutes, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteIntensitiesWide)\n",
    "\n",
    "\n",
    "###### minute Intensities Data Narrow.\n",
    "\n",
    "minuteIntensitiesNarrow <- minuteIntensitiesNarrow   %>%\n",
    "  clean_names() \n",
    "colnames(minuteIntensitiesNarrow)[2] <- \"minutes\"\n",
    "minuteIntensitiesNarrow <- minuteIntensitiesNarrow %>%\n",
    "  mutate(minutes = parse_date_time(minutes, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteIntensitiesNarrow <- minuteIntensitiesNarrow %>%\n",
    "  separate(col = minutes, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteIntensitiesNarrow)\n",
    "\n",
    "\n",
    "###### minute METs Data Narrow.\n",
    "\n",
    "minuteMETsNarrow <- minuteMETsNarrow   %>%\n",
    "  clean_names() \n",
    "colnames(minuteMETsNarrow)[2] <- \"minutes\"\n",
    "minuteMETsNarrow <- minuteMETsNarrow %>%\n",
    "  mutate(minutes = parse_date_time(minutes, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteMETsNarrow <- minuteMETsNarrow %>%\n",
    "  separate(col = minutes, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteMETsNarrow)\n",
    "\n",
    "###### minute Steps Narrow.\n",
    "\n",
    "minuteStepsWide <- minuteStepsWide   %>%\n",
    "  clean_names() \n",
    "colnames(minuteStepsWide)[2] <- \"minutes\"\n",
    "minuteStepsWide <- minuteStepsWide %>%\n",
    "  mutate(minutes = parse_date_time(minutes, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteStepsWide <- minuteStepsWide %>%\n",
    "  separate(col = minutes, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteStepsWide)\n",
    "\n",
    "\n",
    "###### minute Steps Narrow.\n",
    "\n",
    "minuteStepsNarrow <- minuteStepsNarrow   %>%\n",
    "  clean_names() \n",
    "colnames(minuteStepsNarrow)[2] <- \"minutes\"\n",
    "minuteStepsNarrow <- minuteStepsNarrow %>%\n",
    "  mutate(minutes = parse_date_time(minutes, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteStepsNarrow <- minuteStepsNarrow %>%\n",
    "  separate(col = minutes, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteStepsNarrow)\n",
    "\n",
    "\n",
    "###### minute Sleeps Narrow.\n",
    "\n",
    "minuteSleepWide <- minuteSleepWide   %>%\n",
    "  clean_names() %>%\n",
    "  distinct()\n",
    "colnames(minuteSleepWide)[2] <- \"minutes\"\n",
    "colnames(minuteSleepWide)[3] <- \"sleeps\"\n",
    "minuteSleepWide <- minuteSleepWide %>%\n",
    "  mutate(minutes = parse_date_time(minutes, \"%m/%d/%Y %I:%M:%S\"))\n",
    "minuteSleepWide <- minuteSleepWide %>%\n",
    "  separate(col = minutes, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(minuteSleepWide)\n",
    "\n",
    "\n",
    "###### sleepDay Data.\n",
    "\n",
    "sleepDay <- sleepDay   %>%\n",
    "  clean_names() %>%\n",
    "  distinct()\n",
    "colnames(sleepDay)[2] <- \"date\"\n",
    "\n",
    "sleepDay <- sleepDay %>%\n",
    "  mutate(date = parse_date_time(date, \"%m/%d/%Y %I:%M:%S\"))\n",
    "sleepDay <- sleepDay %>%\n",
    "  separate(col = date, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(sleepDay)\n",
    "\n",
    "\n",
    "###### weightLogInfo Data.\n",
    "\n",
    "weightLogInfo <- weightLogInfo   %>%\n",
    "  clean_names()  \n",
    "weightLogInfo <- weightLogInfo[ , colSums(is.na(weightLogInfo)) == 0]\n",
    "weightLogInfo <- weightLogInfo %>%\n",
    "  mutate(date = parse_date_time(date, \"%m/%d/%Y %I:%M:%S\"))\n",
    "weightLogInfo <- weightLogInfo %>%\n",
    "  separate(col = date, into = c(\"date\", \"time\"), sep = \" \") %>%\n",
    "  mutate(Date = as.Date(date),time = format(strptime(time, \"%H:%M:%S\"), \"%H:%M\")) %>% \n",
    "  group_by(id, date, time)\n",
    "print(weightLogInfo)\n",
    "\n",
    "\n",
    "\n",
    "```\n",
    "\n",
    "## Data Processing\n",
    "\n",
    "This stage is where we shall be aggregating data,combining the data sets to come up with one final data set.I also did data reduction by selecting the relevant features and variables to my study.Feature engineering was also done by adding week day column  using the existing date column.\n",
    "\n",
    "This study focused on the daily observations.Calories,steps and intensities are going to be omitted as they are already in the daily activity table.\n",
    "\n",
    "I merged heartrate, weight, activity data and sleep data to create my final data set.\n",
    "\n",
    "\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "fitness_data <- merge(\n",
    "  merge(\n",
    "    merge(dailyActivity, sleepDay, by = c('id', 'date'), all = TRUE),\n",
    "    weightLogInfo, by = c('id', 'date'), all = TRUE),\n",
    "  heatrateSeconds,by = c('id','date'),all = TRUE) %>%\n",
    "  group_by(id,date) %>%\n",
    "  distinct() %>%\n",
    "  clean_names() \n",
    "\n",
    "# remove unncessary columns\n",
    "#I removed tracker_distance as it was the same as tota_distance.Some columns are not useful like weight_pounds as we are going to use weight_kg.\n",
    "\n",
    "fitness_data <- subset(fitness_data, select = -c(time,tracker_distance,is_manual_report,total_sleep_records,weight_pounds,bmi,log_id,time_x,time_y,date_2) )\n",
    "\n",
    "#add day of week column for analysis\n",
    "fitness_data$week_day <- weekdays(fitness_data$date)\n",
    "\n",
    "#view summary \n",
    "\n",
    "#Below is the summary of the final dataset provided by 33 participants as found from calling the unique function\n",
    "summary(fitness_data)\n",
    "n_unique(fitness_data$id)\n",
    "\n",
    "\n",
    "```\n",
    "\n",
    "\n",
    "\n",
    "## Data Analysis and Visualization\n",
    "In this stage I did descriptive analysis on the final data and drew conclutions from the data.I also recommended actions and represented data graphically.\n",
    "\n",
    "### Are there any relationships between variables in the final data.\n",
    "\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "\n",
    "#a.\tCalories vs step\n",
    "fitness_data %>%\n",
    "group_by(total_steps, calories) %>% \n",
    "  ggplot(aes(x = total_steps, y = calories, color = calories)) +\n",
    "  geom_point() +\n",
    "  geom_smooth() + \n",
    "  labs(title = 'Calories burned vs total steps taken',\n",
    "       y = 'Calories',\n",
    "       x = 'Total Steps',\n",
    "       caption = 'FitBit Fitness Tracker Data')\n",
    "```\n",
    "\n",
    "\n",
    "\n",
    "From the graph ,as the total number of steps increases more calories are being burnt.We can use the cor.test to confirm this relationship.\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "cor.test(fitness_data$total_steps, fitness_data$calories, method = 'pearson', conf.level = 0.95)\n",
    "```\n",
    "The cor confirms that more calories can burnt by taking more steps per day.\n",
    "\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "\n",
    "#####b.\tStep vs weekday\n",
    "fitness_data %>% \n",
    "  select(week_day, total_steps) %>% \n",
    "  mutate(week_day = factor(week_day, levels = c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) %>% \n",
    "  drop_na() %>% \n",
    "  ggplot(aes(week_day, total_steps, fill = week_day)) +\n",
    "  geom_boxplot() +\n",
    "  scale_fill_brewer(palette=\"Set2\") +\n",
    "  labs(\n",
    "    title = \"Steps taken in a day\",\n",
    "    x = \"Day of the week\",\n",
    "    y = \"Steps\",\n",
    "    caption = 'FitBit Fitness Tracker Data'\n",
    "  )\n",
    "```\n",
    "\n",
    "It can be seen from the distribution that Saturday more steps are being taken and also the distribution of steps during the week is fair.\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "#####c.\tCalories vs week_day\n",
    "fitness_data %>% \n",
    "  select(week_day, calories) %>% \n",
    "  mutate(week_day = factor(week_day, levels = c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) %>% \n",
    "  drop_na() %>% \n",
    "  ggplot(aes(week_day, calories, fill = week_day)) +\n",
    "  geom_boxplot() +\n",
    "  scale_fill_brewer(palette=\"Set2\") +\n",
    "  labs(\n",
    "    title = \"Calories burnt by day\",\n",
    "    x = \"Day of the week\",\n",
    "    y = \"Calories\",\n",
    "    caption = 'FitBit Fitness Tracker Data'\n",
    "  )\n",
    "```\n",
    "\n",
    "It can be seen that saturday also has the most burnt calories in as much as there is a fairly distribution of calories burnt accross the week.\n",
    "\n",
    "\n",
    "From the analysi done so far we can conclude that there is a relationship between calories burnt and steps taken.The more steps taken,the more calories burnt.\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "\n",
    "\n",
    "#####d.\twhat level of activity is most frequent per distance covered\n",
    "activity_level_data <- fitness_data %>%\n",
    "  ungroup() %>%\n",
    "  select(sedentary_active_distance, \n",
    "        light_active_distance, \n",
    "         moderately_active_distance,\n",
    "         very_active_distance) %>% \n",
    "  drop_na()\n",
    "\n",
    "activity_level_data %>% \n",
    "  \n",
    "  summarise(across(everything(), list(sum))) %>% \n",
    "  gather(activities, value) %>% \n",
    "  mutate(ratio = value / sum(value),\n",
    "         label = percent(ratio %>% round(4))) %>% \n",
    "  mutate(activities = factor(activities, \n",
    "                             labels = c('Light','Moderate','Sedentary', 'Heavy'))) %>% \n",
    "  ggplot(aes(x = (activities), \n",
    "             y = value, \n",
    "             label = label, \n",
    "             fill = activities)) +\n",
    "  geom_bar(stat='identity') +\n",
    "  geom_label(aes(label = label), \n",
    "             fill = \"beige\", \n",
    "             colour = \"black\",\n",
    "             vjust = 0.5) +\n",
    "  labs(\n",
    "    title = \"Intensity of Activity\",\n",
    "    x = \"Level  of Activity\",\n",
    "    y = \"Distance Covered\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "```\n",
    "From the graph the light activity is more frequent and the percentage of people doing nothing is almost zero.\n",
    "\n",
    "```{r message=FALSE, warning=FALSE}\n",
    "#####e.\tlevel of activity during the week\n",
    "\n",
    "weekly_activity_level_data <- fitness_data %>%\n",
    "  ungroup() %>%\n",
    "  select(sedentary_active_distance, \n",
    "         light_active_distance, \n",
    "         moderately_active_distance,\n",
    "         very_active_distance,week_day) %>% \n",
    "  drop_na()\n",
    "\n",
    "weekly_sedentary_activities<-aggregate(weekly_activity_level_data$sedentary_active_distance, by=list(week_day=weekly_activity_level_data$week_day), FUN=sum)\n",
    "weekly_light_activities<-aggregate(weekly_activity_level_data$light_active_distance, by=list(week_day=weekly_activity_level_data$week_day), FUN=sum)\n",
    "weekly_moderately_activities<-aggregate(weekly_activity_level_data$moderately_active_distance, by=list(week_day=weekly_activity_level_data$week_day), FUN=sum)\n",
    "weekly_heavy_activities<-aggregate(weekly_activity_level_data$very_active_distance, by=list(week_day=weekly_activity_level_data$week_day), FUN=sum)\n",
    "\n",
    "weekly_sedentary_activities %>% \n",
    "  mutate(week_day = factor(week_day, levels = c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) %>% \n",
    "  ggplot(aes(x = week_day, \n",
    "             y = x, \n",
    "             fill = week_day)) +\n",
    "  geom_bar(stat='identity') +\n",
    "  labs(\n",
    "    title = \"Sedendary Activity\",\n",
    "    x = \"Day of Week\",\n",
    "    y = \"Distance Covered\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "\n",
    "weekly_moderately_activities %>% \n",
    "  mutate(week_day = factor(week_day, levels = c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) %>% \n",
    "  ggplot(aes(x = week_day, \n",
    "             y = x, \n",
    "             fill = week_day)) +\n",
    "  geom_bar(stat='identity') +\n",
    "  labs(\n",
    "    title = \"Moderate Activity\",\n",
    "    x = \"Day of Week\",\n",
    "    y = \"Distance Covered\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "weekly_heavy_activities %>% \n",
    "  mutate(week_day = factor(week_day, levels = c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) %>% \n",
    "  ggplot(aes(x = week_day, \n",
    "             y = x, \n",
    "             fill = week_day)) +\n",
    "  geom_bar(stat='identity') +\n",
    "  labs(\n",
    "    title = \"Heavy Activity\",\n",
    "    x = \"Day of Week\",\n",
    "    y = \"Distance Covered\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "weekly_light_activities %>% \n",
    "  mutate(week_day = factor(week_day, levels = c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'))) %>% \n",
    "  ggplot(aes(x = week_day, \n",
    "             y = x, \n",
    "             fill = week_day)) +\n",
    "  geom_bar(stat='identity') +\n",
    "  labs(\n",
    "    title = \"Light Activity\",\n",
    "    x = \"Day of Week\",\n",
    "    y = \"Distance Covered\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "```\n",
    "\n",
    "From the graphs above ,\n",
    "\n",
    "From the people who are sedentary Most of them are sedentary on Thursday with Wednesday and Sunday showing no one being sedentary.Apart from Wednesday and Sunday, Saturday has the least number of people doing nothing.\n",
    "\n",
    "From the people who do moderate activities,most people are moderate on Thursday  and least on Sunday.\n",
    "As the week start people doing moderate activities increases and start decreasing from mid-weak to friday.There is a slight increase in the numbers on Saturday\n",
    "\n",
    "From the people tacking Heavy activities.People are most active midweek and they start with few numbers and end with few number on Friday,Saturday the numbers rise all of a sudden again.\n",
    "\n",
    "From the people doing light activities,the distribution is almost fair across the week,how the trend of Sunday having least activities and Saturday having a sudden rise in numbers.People are most active mid-weak again with Tuesday being most active.\n",
    "\n",
    "Fom this analysis it can be concluded that people are most active on the midweek ,and least active on Sunday.It can also be seen that Saturday some people start taking activities.\n",
    "\n",
    "```{r message=FALSE, warning=FALSE }\n",
    "#####f.\tSleep Analysis\n",
    "\n",
    "sleep_analysis <- fitness_data %>%\n",
    "  ungroup() %>%\n",
    "  select(id,\n",
    "         light_active_distance,\n",
    "         weight_kg,\n",
    "         total_steps,\n",
    "         total_minutes_asleep,\n",
    "         total_time_in_bed,\n",
    "         week_day\n",
    "         \n",
    "    ) %>% \n",
    "  drop_na() \n",
    "\n",
    " sleep_analysis$trouble_sleeping_time <- (sleep_analysis$total_time_in_bed - sleep_analysis$total_minutes_asleep)\n",
    "```\n",
    " \n",
    " \n",
    " we created the data frame with data we are going to use to see the sleeping trends\n",
    "```{r message=FALSE, warning=FALSE }\n",
    "##### step vs time failing to sleep with id as a factor\n",
    "sleep_analysis %>%\n",
    "  ggplot(aes(x = total_steps, \n",
    "             y = trouble_sleeping_time, \n",
    "  )) +\n",
    " \n",
    "  geom_point(aes( color = id, size = total_steps), alpha = 0.5) +\n",
    "  geom_smooth()+\n",
    "  labs(\n",
    "    title = \" Trouble Sleeping Time vs Steps\",\n",
    "    x = \"Steps\",\n",
    "    y = \"Time\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "```\n",
    "* From this graph we can see that majority of people are spenting 30 minutes in bad and not asleep.However there are some outliers failing to sleep.\n",
    "* We factor in weight to see why some people are failing to sleep.\n",
    "\n",
    "```{r message=FALSE, warning=FALSE }\n",
    "##### step vs time failing to sleep with weight as a factor\n",
    "sleep_analysis %>%\n",
    "  ggplot(aes(x = total_steps, \n",
    "             y = trouble_sleeping_time, \n",
    "  )) +\n",
    " \n",
    "  geom_point(aes( color = weight_kg, size = total_steps), alpha = 0.5) +\n",
    "  geom_smooth()+\n",
    "  labs(\n",
    "    title = \" Trouble Sleeping Time vs Steps \",\n",
    "    x = \"Steps\",\n",
    "    y = \"Time\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "```\n",
    "* From the graph we can see that majority of people with 60-70kg are sleeping very weLL better than those with high weight.however the outliers are in the same weight hence we factor in the light_active distance to see why.\n",
    "* There is also an outlier group of people weighing between 80-100 sleep well than some with a lower weight.Does that mean with a higher weight you sleep easily ?\n",
    "* people with a lower weight taking same distance as those with 80-100 are sleeping better and the numbers are high hence those sleeping less are outliers.why?\n",
    "*it can be seen that the once with 80-100 are having more steps than the ouliers.\n",
    "\n",
    "\n",
    "```{r message=FALSE, warning=FALSE }\n",
    "\n",
    "##### step vs time failing to sleep with light_active distance as a factor\n",
    "sleep_analysis %>%\n",
    "  ggplot(aes(x = total_steps, \n",
    "             y = trouble_sleeping_time, \n",
    "  )) +\n",
    " \n",
    "  geom_point(aes( color = light_active_distance, size = total_steps), alpha = 0.5) +\n",
    "  geom_smooth()+\n",
    "  labs(\n",
    "    title = \" Trouble Sleeping Time vs Steps\",\n",
    "    x = \"Steps\",\n",
    "    y = \"Time\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "\n",
    "\n",
    "\n",
    "```\n",
    "\n",
    "* It can be seen from the graph that the outliers failing to sleep are having low light_active_distance\n",
    "* It looks like the less the light active distance the less you sleep well ,looking at the people with same weight and walking same distance.\n",
    "* There is also an outlier who is sleeping very well with a high light_active_distance.\n",
    "* The group of people with high weight 80-100kg  and sleeping better than outlier with 60-70k are having same low alight_active distance.\n",
    "\n",
    "\n",
    "\n",
    "* Overally people having more active distance and number of steps are having a better sleep 10000-15000kg.\n",
    "\n",
    "\n",
    "\n",
    "```{r message=FALSE, warning=FALSE }\n",
    "#####h.weight vs steps\n",
    "fitness_data %>%\n",
    "  ungroup() %>%\n",
    "  select(\n",
    "    id,\n",
    "    total_steps,\n",
    "    weight_kg\n",
    "    \n",
    "  ) %>% \n",
    "  group_by(weight_kg) %>%\n",
    "  drop_na() %>%\n",
    " ggplot(aes(x = weight_kg, \n",
    "             y = total_steps, \n",
    "             )) +\n",
    "  geom_point(aes(color = id, size = weight_kg), alpha = 0.5) +\n",
    "  geom_smooth()+\n",
    "  labs(\n",
    "    title = \"Weight vs steps\",\n",
    "    x = \"Weight\",\n",
    "    y = \"Steps Taken\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "\n",
    "```\n",
    "\n",
    "On average people weight is ok however is an otlier with high weight who is failing to take many steps a day.\n",
    "\n",
    "```{r message=FALSE, warning=FALSE }\n",
    "#####i.weight vs heartrate\n",
    "\n",
    "fitness_data %>%\n",
    "  ungroup() %>%\n",
    "  select(\n",
    "    id,\n",
    "    total_distance,\n",
    "    total_steps,\n",
    "    heart_rate,\n",
    "    weight_kg\n",
    "    \n",
    "  ) %>% \n",
    "  group_by(weight_kg) %>%\n",
    "  drop_na() %>%\n",
    "  ggplot(aes(x = weight_kg, \n",
    "             y = heart_rate, \n",
    "  )) +\n",
    "  geom_point(aes(color = id, size = total_distance), alpha = 0.5) +\n",
    "  geom_smooth()+\n",
    "  labs(\n",
    "    title = \"Heart Rate vs steps\",\n",
    "    x = \"Weight\",\n",
    "    y = \"Heart Rate\",\n",
    "    caption = ' FitBit Fitness Tracker Data'\n",
    "  )\n",
    "```\n",
    "there is no much here is the heartrate for users is evenly distrubed for different weights.\n",
    "\n",
    "## SHARE\n",
    "\n",
    "In this stage I summarise the insights and give recommendations.\n",
    "### KEY INSIGHTS\n",
    "\n",
    "* calories are burnt more by more steps taken\n",
    "* on Sunday people are less active\n",
    "* most people prefer the light activity\n",
    "* people are most active during the midweek\n",
    "* people start relaxing till Friday and a fraction of people are active again on Saturday leading to an  increase in the number of active people\n",
    "* on Sundays and Wednesday no one is sedentary\n",
    "* increasing number of steps and having high light_active_distance also helps in having a better sleep\n",
    "* people with low weight are sleeping and stepping better than those with with high weight with all things equal.\n",
    "* people with higher weight can improve their sleep by taking more steps and active distance.\n",
    "   \n",
    "   \n",
    "   \n",
    "### RECOMMENDATIONS\n",
    " * Bella beat could include a feature on their time product to give light active ideas and challenges on sundays where most people are lazy to motivate users.\n",
    " \n",
    " * Bella beat could include a feature to remind users to log their demographics like age and location for use for their marketing analysis.\n",
    " \n",
    " * Bella beat could share some ideas on how to burn calories to motivate users.\n",
    " \n",
    " * Bella beat could target people who want to put their body in shape .\n",
    " \n",
    " * Bella beat could target people who loves being active and want to stay healthy by running."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9dcb7bb6",
   "metadata": {
    "_cell_guid": "97ac004e-d460-4d5e-b986-8af27e198048",
    "_uuid": "ed5b9279-2ca7-4b52-885b-45ec9b881668",
    "papermill": {
     "duration": 0.002268,
     "end_time": "2024-09-24T21:27:00.992088",
     "exception": false,
     "start_time": "2024-09-24T21:27:00.989820",
     "status": "completed"
    },
    "tags": []
   },
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 5760094,
     "sourceId": 9471699,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5761582,
     "sourceId": 9473750,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30749,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "r",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "R",
   "language": "R",
   "name": "ir"
  },
  "language_info": {
   "codemirror_mode": "r",
   "file_extension": ".r",
   "mimetype": "text/x-r-source",
   "name": "R",
   "pygments_lexer": "r",
   "version": "4.4.0"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 3.206831,
   "end_time": "2024-09-24T21:27:01.116207",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-09-24T21:26:57.909376",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
